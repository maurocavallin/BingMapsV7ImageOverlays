var ImageOverlay;(function(){var b=0;function a(){var c="strechedImg"+b;b++;if(window[c]){return a()}return c}ImageOverlay=function(j,f,d){var h=new Microsoft.Maps.Pushpin(d.center);var c=1;var e=a();function g(){var l=i();var k={width:null,height:null,anchor:new Microsoft.Maps.Point(l.width/2,l.height/2),htmlContent:"<img id='"+e+"' style='width:"+l.width+"px;height:"+l.height+"px;opacity:"+c+";filter:alpha(opacity="+(c*100)+");' src='"+f+"'/>"};h.setOptions(k)}function i(){var n=j.tryLocationToPixel(d.getNorthwest());var l=j.tryLocationToPixel(d.getSoutheast());var m=Math.abs(l.x-n.x);var k=Math.abs(n.y-l.y);return{width:m,height:k}}h.Refresh=function(){var k=i();h.setOptions({anchor:new Microsoft.Maps.Point(k.width/2,k.height/2)});var l=document.getElementById(e);if(l){l.style.width=k.width+"px";l.style.height=k.height+"px"}};h.SetOpacity=function(k){if(k>=0||opctity<=1){c=k;g()}};Microsoft.Maps.Events.addHandler(j,"viewchange",function(k){if(!k.linear){h.Refresh()}});g();return h}})();Microsoft.Maps.moduleLoaded("ImageOverlayModule");